import {
  cleanText,
  cubicSplineInterpolation,
  interpolateArray,
  monotoneCubicInterpolation,
  normalizeArray,
} from "./helpers";

export default async function OG({
  speakerImageUrl,
  prompt,
  audioArray,
}: {
  width: number;
  height: number;
  speakerImageUrl: string | null;
  prompt: string;
  audioArray: number[] | null;
}) {
  prompt = cleanText(prompt).slice(0, 200);

  const padding = 32;
  const bgColor = "rgb(18, 18, 23)";
  const onBgColor = "rgb(220, 220, 234)";
  const primaryColor = "rgb(181 140 255)";
  const dotColor = "rgba(220, 220, 234, 0.03)";
  const dotDistance = 32;
  const dotSizePercent = 5;

  const valueMin = 0.4;
  const valueCount = 40;
  const placeholderArray = Array.from({ length: valueCount }).map(
    () => Math.random() * (1 - valueMin) + valueMin
  );
  const audioArrayFinal = monotoneCubicInterpolation(
    normalizeArray({
      array: audioArray ?? placeholderArray,
      min: valueMin,
    }),
    valueCount
  );
  return (
    <div
      style={{
        background: bgColor,
        color: onBgColor,
        padding: padding,
        backgroundImage: `
          radial-gradient(circle at 0px 0px, ${dotColor} ${dotSizePercent}%, transparent 0%),
          radial-gradient(circle at 0px ${dotDistance}px, ${dotColor} ${dotSizePercent}%, transparent 0%),
          radial-gradient(circle at ${dotDistance}px 0px, ${dotColor} ${dotSizePercent}%, transparent 0%),
          radial-gradient(circle at ${dotDistance}px ${dotDistance}px, ${dotColor} ${dotSizePercent}%, transparent 0%)
        `,
        backgroundSize: `${dotDistance}px ${dotDistance}px`,
      }}
      tw="flex flex-col w-full h-full items-center justify-center"
    >
      {/* Header */}
      <div
        style={{ marginTop: -32 }}
        tw="w-full flex justify-between items-center"
      >
        {speakerImageUrl && (
          <div tw="flex" style={{ paddingRight: 18 }}>
            <img
              style={{
                width: 48,
                height: 48,
                background: "rgb(220, 220, 234)",
                borderRadius: 10,
              }}
              src={speakerImageUrl}
            ></img>
          </div>
        )}
        <p
          style={{
            fontSize: 32,
            whiteSpace: "nowrap",
            overflow: "hidden",
            paddingBottom: 12,
            paddingRight: 48,
            textOverflow: "ellipsis",
            fontWeight: 500,
          }}
          tw="flex-1 min-w-0"
        >
          {prompt}
          {prompt && prompt.length > 0 ? "" : "..."}
        </p>
        <svg
          style={{
            width: 210.4446,
            height: 48.4,
          }}
          viewBox="0 0 287 66"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M1.83053 49.6532C0.516626 50.9671 0.502996 53.1254 2.01536 54.2049C2.52575 54.5692 3.04929 54.907 3.58406 55.218C4.56173 55.7868 5.10857 56.9186 4.81583 58.0111C4.57537 58.9085 5.10794 59.8309 6.00535 60.0714L9.25517 60.9422C10.1526 61.1827 11.075 60.6501 11.3155 59.7527L11.3308 59.6953C11.6155 58.6329 12.6259 57.9448 13.7258 57.9448C14.8256 57.9448 15.836 58.6329 16.1207 59.6953L16.136 59.7526C16.3765 60.6501 17.2989 61.1826 18.1963 60.9422L21.4462 60.0714C22.3436 59.8309 22.8761 58.9085 22.6357 58.0111L22.6216 57.9587C22.337 56.8964 22.8581 55.8009 23.8105 55.251C24.7637 54.7007 25.9936 54.7839 26.7719 55.5622L26.8104 55.6007C27.4673 56.2577 28.5325 56.2577 29.1894 55.6007L31.5685 53.2217C32.2254 52.5648 32.2254 51.4996 31.5685 50.8427L31.5299 50.8041C30.7517 50.0259 30.6684 48.796 31.2187 47.8428C31.7686 46.8904 32.8641 46.3693 33.9264 46.6539L33.9788 46.6679C34.8762 46.9084 35.7986 46.3758 36.0391 45.4784L36.9099 42.2286C37.1503 41.3312 36.6178 40.4088 35.7204 40.1683L35.6631 40.153C34.6007 39.8683 33.9125 38.8579 33.9125 37.758C33.9125 36.6581 34.6007 35.6477 35.6631 35.363L35.7203 35.3477C36.6178 35.1072 37.1503 34.1848 36.9099 33.2874L36.0391 30.0376C35.7986 29.1401 34.8762 28.6076 33.9788 28.848C32.8863 29.1408 31.7545 28.594 31.1858 27.6163C30.3268 26.1397 29.2648 24.7487 27.9999 23.4838L1.83053 49.6532Z"
            fill="url(#paint0_linear_1060_66734)"
          />
          <path
            d="M1.83053 49.6532C0.516626 50.9671 0.502996 53.1254 2.01536 54.2049C2.52575 54.5692 3.04929 54.907 3.58406 55.218C4.56173 55.7868 5.10857 56.9186 4.81583 58.0111C4.57537 58.9085 5.10794 59.8309 6.00535 60.0714L9.25517 60.9422C10.1526 61.1827 11.075 60.6501 11.3155 59.7527L11.3308 59.6953C11.6155 58.6329 12.6259 57.9448 13.7258 57.9448C14.8256 57.9448 15.836 58.6329 16.1207 59.6953L16.136 59.7526C16.3765 60.6501 17.2989 61.1826 18.1963 60.9422L21.4462 60.0714C22.3436 59.8309 22.8761 58.9085 22.6357 58.0111L22.6216 57.9587C22.337 56.8964 22.8581 55.8009 23.8105 55.251C24.7637 54.7007 25.9936 54.7839 26.7719 55.5622L26.8104 55.6007C27.4673 56.2577 28.5325 56.2577 29.1894 55.6007L31.5685 53.2217C32.2254 52.5648 32.2254 51.4996 31.5685 50.8427L31.5299 50.8041C30.7517 50.0259 30.6684 48.796 31.2187 47.8428C31.7686 46.8904 32.8641 46.3693 33.9264 46.6539L33.9788 46.6679C34.8762 46.9084 35.7986 46.3758 36.0391 45.4784L36.9099 42.2286C37.1503 41.3312 36.6178 40.4088 35.7204 40.1683L35.6631 40.153C34.6007 39.8683 33.9125 38.8579 33.9125 37.758C33.9125 36.6581 34.6007 35.6477 35.6631 35.363L35.7203 35.3477C36.6178 35.1072 37.1503 34.1848 36.9099 33.2874L36.0391 30.0376C35.7986 29.1401 34.8762 28.6076 33.9788 28.848C32.8863 29.1408 31.7545 28.594 31.1858 27.6163C30.3268 26.1397 29.2648 24.7487 27.9999 23.4838L1.83053 49.6532Z"
            fill="url(#paint1_linear_1060_66734)"
          />
          <path
            d="M5.39912 15.1572C4.74217 14.5002 4.74217 13.4351 5.39912 12.7781L7.77816 10.3991C8.43511 9.74214 9.50024 9.74214 10.1572 10.3991L10.1957 10.4376C10.974 11.2159 12.2039 11.2991 13.1571 10.7488C14.1095 10.199 14.6306 9.10341 14.346 8.04114L14.332 7.98883C14.0915 7.09142 14.6241 6.16899 15.5215 5.92852L18.7713 5.05774C19.6687 4.81728 20.5912 5.34984 20.8316 6.24726L20.8469 6.30445C21.1316 7.36689 22.142 8.05507 23.2419 8.05508C24.3418 8.05508 25.3522 7.36689 25.6369 6.30445L25.6522 6.24729C25.8927 5.34988 26.8151 4.81731 27.7125 5.05777L30.9624 5.92856C31.8598 6.16902 32.3923 7.09145 32.1519 7.98887C31.8592 9.08135 32.406 10.2131 33.3836 10.7818C33.9183 11.0929 34.4419 11.4306 34.9522 11.7949C36.4646 12.8745 36.451 15.0328 35.1371 16.3467L8.96767 42.5161C7.70278 41.2512 6.64083 39.8602 5.78184 38.3836C5.21312 37.4059 4.08133 36.8591 2.98883 37.1518C2.09142 37.3923 1.16899 36.8597 0.928525 35.9623L0.0577381 32.7125C-0.182723 31.8151 0.349842 30.8926 1.24726 30.6522L1.30451 30.6368C2.36693 30.3521 3.0551 29.3418 3.0551 28.2419C3.0551 27.142 2.36693 26.1316 1.30451 25.8469L1.24728 25.8316C0.349868 25.5911 -0.182696 24.6687 0.0577652 23.7713L0.928552 20.5215C1.16901 19.6241 2.09144 19.0915 2.98886 19.332L3.04116 19.346C4.10344 19.6306 5.19899 19.1095 5.74886 18.1571C6.29917 17.2039 6.21592 15.974 5.43765 15.1957L5.39912 15.1572Z"
            fill="url(#paint2_linear_1060_66734)"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M6.11003 14.4463C5.45307 13.7893 5.45307 12.7242 6.11003 12.0673L5.39912 12.7782C4.74217 13.4351 4.74217 14.5002 5.39912 15.1572L5.43765 15.1957C6.21592 15.974 6.29917 17.2039 5.74886 18.1571C5.71939 18.2082 5.68835 18.258 5.65583 18.3065C5.97885 18.0912 6.25657 17.7982 6.45977 17.4462C7.01008 16.493 6.92683 15.2631 6.14855 14.4848L6.11003 14.4463ZM1.77319 19.4666C1.37127 19.6771 1.05525 20.0487 0.928552 20.5215L0.0577652 23.7713C-0.182696 24.6687 0.349868 25.5912 1.24728 25.8316L1.30451 25.847C2.36693 26.1316 3.0551 27.142 3.0551 28.2419C3.0551 28.7514 2.90744 29.2417 2.64333 29.6495C3.34099 29.2045 3.76601 28.3954 3.76601 27.531C3.76601 26.4311 3.07783 25.4207 2.01541 25.1361L1.95819 25.1207C1.06077 24.8803 0.52821 23.9578 0.768671 23.0604L1.63946 19.8106C1.67208 19.6889 1.71724 19.5738 1.77319 19.4666ZM0.903216 30.7859C0.219583 31.1424 -0.150105 31.9368 0.0577381 32.7125L0.928525 35.9623C1.16899 36.8597 2.09142 37.3923 2.98883 37.1518C4.08133 36.8591 5.21312 37.4059 5.78184 38.3836C6.64083 39.8602 7.70278 41.2512 8.96767 42.5161L9.67858 41.8052C8.41368 40.5403 7.35174 39.1493 6.49275 37.6727C5.92403 36.695 4.79224 36.1482 3.69974 36.4409C2.80232 36.6814 1.87989 36.1488 1.63943 35.2514L0.768644 32.0016C0.654878 31.577 0.714145 31.1468 0.903216 30.7859ZM2.53768 48.9461L1.83053 49.6532C0.516627 50.9671 0.502998 53.1254 2.01536 54.205C2.52575 54.5693 3.04929 54.907 3.58406 55.2181C4.56173 55.7868 5.10857 56.9186 4.81584 58.0112C4.57537 58.9086 5.10794 59.831 6.00535 60.0715L9.25517 60.9422C10.0309 61.1501 10.8252 60.7804 11.1817 60.0968C10.8208 60.2858 10.3907 60.3451 9.96611 60.2313L6.71629 59.3605C5.81887 59.1201 5.28631 58.1976 5.52677 57.3002C5.81951 56.2077 5.27267 55.0759 4.295 54.5072C3.76023 54.1961 3.23668 53.8584 2.7263 53.494C1.21539 52.4155 1.22754 50.2603 2.53768 48.9461ZM12.3182 58.3566C12.726 58.0925 13.2163 57.9448 13.7258 57.9448C14.8256 57.9448 15.836 58.633 16.1207 59.6954L16.136 59.7527C16.3765 60.6501 17.2989 61.1827 18.1963 60.9422L21.4462 60.0714C21.919 59.9447 22.2906 59.6287 22.5011 59.2268C22.3938 59.2827 22.2788 59.3279 22.1571 59.3605L18.9073 60.2313C18.0099 60.4717 17.0874 59.9392 16.847 59.0418L16.8316 58.9845C16.5469 57.922 15.5366 57.2339 14.4367 57.2339C13.5723 57.2339 12.7632 57.6589 12.3182 58.3566ZM23.6612 55.3441C23.7097 55.3115 23.7595 55.2805 23.8105 55.251C24.7637 54.7007 25.9936 54.784 26.7719 55.5623L26.8104 55.6008C27.4673 56.2577 28.5325 56.2577 29.1894 55.6008L29.9004 54.8899C29.2434 55.5468 28.1783 55.5468 27.5213 54.8899L27.4828 54.8513C26.7045 54.0731 25.4746 53.9898 24.5214 54.5401C24.1695 54.7433 23.8764 55.021 23.6612 55.3441ZM32.0227 46.9826C32.5737 46.6153 33.2567 46.4745 33.9264 46.654L33.9788 46.668C34.7545 46.8758 35.5489 46.5062 35.9054 45.8225C35.5445 46.0116 35.1143 46.0708 34.6897 45.9571L34.6373 45.943C33.632 45.6736 32.5968 46.126 32.0227 46.9826ZM35.0352 35.6395C35.2253 35.5183 35.4356 35.424 35.6631 35.3631L35.7203 35.3477C36.1932 35.221 36.5647 34.905 36.7753 34.5031C36.668 34.559 36.553 34.6042 36.4313 34.6368L36.374 34.6522C35.8037 34.805 35.3413 35.1669 35.0352 35.6395ZM26.4969 5.19238C26.095 5.40294 25.7789 5.77449 25.6522 6.24733L25.6369 6.30449C25.576 6.53199 25.4817 6.74233 25.3605 6.93243C25.8331 6.62635 26.195 6.16389 26.3478 5.59358L26.3631 5.53642C26.3958 5.41469 26.4409 5.29967 26.4969 5.19238ZM15.1775 6.0623C14.4938 6.41882 14.1241 7.21319 14.332 7.98887L14.346 8.04117C14.5254 8.7109 14.3846 9.39384 14.0174 9.94493C14.874 9.37075 15.3263 8.33561 15.0569 7.33027L15.0429 7.27796C14.9291 6.85338 14.9884 6.42321 15.1775 6.0623Z"
            fill="url(#paint3_linear_1060_66734)"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M4.94474 19.0175C4.39369 19.3846 3.71083 19.5254 3.04119 19.346L2.98889 19.332C2.21324 19.1241 1.4189 19.4938 1.06236 20.1773C1.42324 19.9883 1.85335 19.9291 2.27787 20.0429L2.33017 20.0569C3.33546 20.3262 4.37054 19.874 4.94474 19.0175ZM1.93226 30.3605C1.74222 30.4817 1.53195 30.5759 1.30454 30.6368L1.24728 30.6522C0.774482 30.7788 0.402951 31.0948 0.192383 31.4967C0.299625 31.4408 0.414591 31.3957 0.536264 31.3631L0.593519 31.3477C1.16376 31.1949 1.62619 30.8331 1.93226 30.3605ZM10.4707 60.8077C10.8727 60.5972 11.1888 60.2256 11.3155 59.7527L11.3309 59.6954C11.3918 59.4678 11.4861 59.2575 11.6074 59.0673C11.1346 59.3734 10.7727 59.8359 10.6198 60.4063L10.6045 60.4636C10.5718 60.5854 10.5266 60.7004 10.4707 60.8077ZM21.7901 59.9377C22.4738 59.5813 22.8436 58.7868 22.6357 58.0111L22.6217 57.9587C22.4422 57.2889 22.583 56.6059 22.9503 56.0548C22.0936 56.629 21.6412 57.6642 21.9106 58.6696L21.9247 58.722C22.0384 59.1466 21.9791 59.5768 21.7901 59.9377ZM29.1782 55.6119C29.182 55.6082 29.1857 55.6045 29.1895 55.6008L31.5685 53.2217C32.2254 52.5648 32.2254 51.4996 31.5685 50.8427L31.5299 50.8041C30.7517 50.0259 30.6684 48.796 31.2187 47.8428C31.2482 47.7917 31.2793 47.7419 31.3118 47.6933C30.9887 47.9086 30.7109 48.2017 30.5077 48.5537C29.9574 49.5069 30.0406 50.7368 30.8189 51.5151L30.8574 51.5536C31.5144 52.2106 31.5144 53.2757 30.8574 53.9327L29.1782 55.6119ZM35.1943 46.5335C35.5963 46.3229 35.9124 45.9514 36.0391 45.4784L36.9099 42.2286C37.1504 41.3312 36.6178 40.4088 35.7204 40.1683L35.6631 40.153C34.6007 39.8683 33.9125 38.8579 33.9125 37.758C33.9125 37.2485 34.0602 36.7582 34.3243 36.3503C33.6266 36.7953 33.2015 37.6045 33.2015 38.4689C33.2015 39.5689 33.8896 40.5792 34.9521 40.8639L35.0093 40.8793C35.9068 41.1197 36.4393 42.0422 36.1989 42.9396L35.3281 46.1894C35.2954 46.3111 35.2503 46.4262 35.1943 46.5335ZM36.0642 35.2141C36.748 34.8576 37.1177 34.0631 36.9099 33.2874L36.0391 30.0376C35.7986 29.1402 34.8762 28.6076 33.9788 28.8481C32.8863 29.1408 31.7545 28.594 31.1858 27.6163C30.3268 26.1397 29.2648 24.7487 27.9999 23.4838L35.1371 16.3467C36.451 15.0328 36.4646 12.8745 34.9523 11.7949C34.4419 11.4306 33.9184 11.0929 33.3836 10.7818C32.406 10.2131 31.8592 9.08135 32.1519 7.98887C32.3924 7.09145 31.8598 6.16902 30.9624 5.92856L27.7126 5.05777C26.9369 4.84994 26.1426 5.21959 25.786 5.90317C26.1469 5.71416 26.577 5.65493 27.0016 5.76868L30.2514 6.63947C31.1488 6.87993 31.6814 7.80236 31.4409 8.69977C31.1482 9.79225 31.695 10.924 32.6726 11.4927C33.2074 11.8038 33.7309 12.1415 34.2412 12.5058C35.7536 13.5854 35.74 15.7437 34.4261 17.0576L27.2889 24.1947C28.5538 25.4596 29.6157 26.8506 30.4747 28.3273C31.0435 29.3049 32.1752 29.8517 33.2677 29.559C34.1652 29.3185 35.0876 29.8511 35.328 30.7485L36.1988 33.9983C36.3126 34.4229 36.2533 34.8531 36.0642 35.2141ZM24.6494 7.64342C24.2416 7.90746 23.7514 8.05508 23.242 8.05508C22.142 8.05507 21.1317 7.36689 20.847 6.30445L20.8316 6.24726C20.5912 5.34984 19.6688 4.81728 18.7713 5.05774L15.5215 5.92852C15.0487 6.05521 14.6772 6.37119 14.4666 6.77308C14.5739 6.71717 14.6888 6.67203 14.8105 6.63943L18.0603 5.76864C18.9577 5.52818 19.8802 6.06075 20.1206 6.95816L20.136 7.01536C20.4206 8.07779 21.431 8.76598 22.5309 8.76598C23.3953 8.76598 24.2043 8.34102 24.6494 7.64342ZM13.3063 10.6559C13.2578 10.6884 13.2081 10.7194 13.1571 10.7488C12.2039 11.2991 10.974 11.2159 10.1957 10.4376L10.1572 10.3991C9.50027 9.74214 8.43514 9.74214 7.77818 10.3991L7.07907 11.0982C7.73692 10.4531 8.7932 10.457 9.4462 11.11L9.48473 11.1485C10.263 11.9268 11.4929 12.0101 12.4461 11.4597C12.798 11.2566 13.091 10.9789 13.3063 10.6559Z"
            fill="url(#paint4_linear_1060_66734)"
          />
          <path
            d="M74.4237 22.848C73.7197 21.952 72.7917 21.248 71.6397 20.736C70.5197 20.192 69.4317 19.92 68.3757 19.92C67.8317 19.92 67.2717 19.968 66.6957 20.064C66.1517 20.16 65.6557 20.352 65.2077 20.64C64.7597 20.896 64.3757 21.248 64.0557 21.696C63.7677 22.112 63.6237 22.656 63.6237 23.328C63.6237 23.904 63.7357 24.384 63.9597 24.768C64.2157 25.152 64.5677 25.488 65.0157 25.776C65.4957 26.064 66.0557 26.336 66.6957 26.592C67.3357 26.816 68.0557 27.056 68.8557 27.312C70.0077 27.696 71.2077 28.128 72.4557 28.608C73.7037 29.056 74.8397 29.664 75.8637 30.432C76.8877 31.2 77.7357 32.16 78.4077 33.312C79.0797 34.432 79.4157 35.84 79.4157 37.536C79.4157 39.488 79.0477 41.184 78.3117 42.624C77.6077 44.032 76.6477 45.2 75.4317 46.128C74.2157 47.056 72.8237 47.744 71.2557 48.192C69.6877 48.64 68.0717 48.864 66.4077 48.864C63.9757 48.864 61.6237 48.448 59.3517 47.616C57.0797 46.752 55.1917 45.536 53.6877 43.968L59.0637 38.496C59.8957 39.52 60.9837 40.384 62.3277 41.088C63.7037 41.76 65.0637 42.096 66.4077 42.096C67.0157 42.096 67.6077 42.032 68.1837 41.904C68.7597 41.776 69.2557 41.568 69.6717 41.28C70.1197 40.992 70.4717 40.608 70.7277 40.128C70.9837 39.648 71.1117 39.072 71.1117 38.4C71.1117 37.76 70.9517 37.216 70.6317 36.768C70.3117 36.32 69.8477 35.92 69.2397 35.568C68.6637 35.184 67.9277 34.848 67.0317 34.56C66.1677 34.24 65.1757 33.904 64.0557 33.552C62.9677 33.2 61.8957 32.784 60.8397 32.304C59.8157 31.824 58.8877 31.216 58.0557 30.48C57.2557 29.712 56.5997 28.8 56.0877 27.744C55.6077 26.656 55.3677 25.344 55.3677 23.808C55.3677 21.92 55.7517 20.304 56.5197 18.96C57.2877 17.616 58.2957 16.512 59.5437 15.648C60.7917 14.784 62.1997 14.16 63.7677 13.776C65.3357 13.36 66.9197 13.152 68.5197 13.152C70.4397 13.152 72.3917 13.504 74.3757 14.208C76.3917 14.912 78.1517 15.952 79.6557 17.328L74.4237 22.848ZM92.6618 30V39.12C92.6618 40.24 92.8698 41.088 93.2858 41.664C93.7338 42.208 94.5178 42.48 95.6378 42.48C96.0218 42.48 96.4218 42.448 96.8378 42.384C97.2858 42.32 97.6538 42.224 97.9418 42.096L98.0378 47.856C97.4938 48.048 96.8058 48.208 95.9738 48.336C95.1418 48.496 94.3098 48.576 93.4778 48.576C91.8778 48.576 90.5338 48.384 89.4458 48C88.3578 47.584 87.4778 47.008 86.8058 46.272C86.1658 45.504 85.7018 44.608 85.4138 43.584C85.1258 42.528 84.9818 41.36 84.9818 40.08V30H81.1418V24.096H84.9338V17.808H92.6618V24.096H98.2778V30H92.6618ZM116.089 37.584H115.081C114.217 37.584 113.337 37.632 112.441 37.728C111.577 37.792 110.793 37.936 110.089 38.16C109.417 38.384 108.857 38.72 108.409 39.168C107.961 39.584 107.737 40.144 107.737 40.848C107.737 41.296 107.833 41.68 108.025 42C108.249 42.32 108.521 42.576 108.841 42.768C109.161 42.96 109.529 43.104 109.945 43.2C110.361 43.264 110.761 43.296 111.145 43.296C112.745 43.296 113.961 42.864 114.793 42C115.657 41.104 116.089 39.904 116.089 38.4V37.584ZM101.641 27.36C103.049 26.016 104.681 25.008 106.537 24.336C108.425 23.664 110.345 23.328 112.297 23.328C114.313 23.328 116.009 23.584 117.385 24.096C118.793 24.576 119.929 25.344 120.793 26.4C121.657 27.424 122.281 28.736 122.665 30.336C123.081 31.904 123.289 33.776 123.289 35.952V48H116.089V45.456H115.945C115.337 46.448 114.409 47.216 113.161 47.76C111.945 48.304 110.617 48.576 109.177 48.576C108.217 48.576 107.225 48.448 106.201 48.192C105.177 47.936 104.233 47.52 103.369 46.944C102.537 46.368 101.849 45.6 101.305 44.64C100.761 43.68 100.489 42.496 100.489 41.088C100.489 39.36 100.953 37.968 101.881 36.912C102.841 35.856 104.057 35.04 105.529 34.464C107.033 33.888 108.697 33.504 110.521 33.312C112.345 33.12 114.121 33.024 115.849 33.024V32.64C115.849 31.456 115.433 30.592 114.601 30.048C113.769 29.472 112.745 29.184 111.529 29.184C110.409 29.184 109.321 29.424 108.265 29.904C107.241 30.384 106.361 30.96 105.625 31.632L101.641 27.36ZM155.805 35.952C155.805 37.616 155.549 39.216 155.037 40.752C154.525 42.288 153.773 43.648 152.781 44.832C151.821 45.984 150.637 46.912 149.229 47.616C147.821 48.32 146.221 48.672 144.429 48.672C142.829 48.672 141.309 48.352 139.869 47.712C138.461 47.04 137.373 46.096 136.605 44.88H136.509V48H129.261V11.712H137.133V26.64H137.229C137.901 25.84 138.845 25.104 140.061 24.432C141.277 23.76 142.765 23.424 144.525 23.424C146.253 23.424 147.805 23.76 149.181 24.432C150.589 25.104 151.773 26.016 152.733 27.168C153.725 28.32 154.477 29.664 154.989 31.2C155.533 32.704 155.805 34.288 155.805 35.952ZM148.221 35.952C148.221 35.184 148.093 34.432 147.837 33.696C147.613 32.96 147.261 32.32 146.781 31.776C146.301 31.2 145.709 30.736 145.005 30.384C144.301 30.032 143.485 29.856 142.557 29.856C141.661 29.856 140.861 30.032 140.157 30.384C139.453 30.736 138.845 31.2 138.333 31.776C137.853 32.352 137.469 33.008 137.181 33.744C136.925 34.48 136.797 35.232 136.797 36C136.797 36.768 136.925 37.52 137.181 38.256C137.469 38.992 137.853 39.648 138.333 40.224C138.845 40.8 139.453 41.264 140.157 41.616C140.861 41.968 141.661 42.144 142.557 42.144C143.485 42.144 144.301 41.968 145.005 41.616C145.709 41.264 146.301 40.8 146.781 40.224C147.261 39.648 147.613 38.992 147.837 38.256C148.093 37.488 148.221 36.72 148.221 35.952ZM160.901 48V11.712H168.869V48H160.901ZM191.566 33.312C191.566 32.064 191.166 30.992 190.366 30.096C189.598 29.2 188.43 28.752 186.862 28.752C186.094 28.752 185.39 28.88 184.75 29.136C184.11 29.36 183.55 29.68 183.07 30.096C182.59 30.512 182.206 31.008 181.918 31.584C181.63 32.128 181.47 32.704 181.438 33.312H191.566ZM198.814 36.336C198.814 36.656 198.814 36.976 198.814 37.296C198.814 37.616 198.798 37.92 198.766 38.208H181.438C181.502 38.88 181.694 39.488 182.014 40.032C182.366 40.576 182.798 41.056 183.31 41.472C183.854 41.856 184.446 42.16 185.086 42.384C185.758 42.608 186.446 42.72 187.15 42.72C188.398 42.72 189.454 42.496 190.318 42.048C191.182 41.568 191.886 40.96 192.43 40.224L197.902 43.68C196.782 45.312 195.294 46.576 193.438 47.472C191.614 48.336 189.486 48.768 187.054 48.768C185.262 48.768 183.566 48.496 181.966 47.952C180.366 47.376 178.958 46.56 177.742 45.504C176.558 44.416 175.614 43.088 174.91 41.52C174.238 39.952 173.902 38.16 173.902 36.144C173.902 34.192 174.238 32.432 174.91 30.864C175.582 29.264 176.494 27.92 177.646 26.832C178.798 25.712 180.158 24.848 181.726 24.24C183.294 23.632 184.99 23.328 186.814 23.328C188.574 23.328 190.19 23.632 191.662 24.24C193.134 24.816 194.398 25.664 195.454 26.784C196.51 27.904 197.326 29.264 197.902 30.864C198.51 32.464 198.814 34.288 198.814 36.336ZM220.16 31.824C219.712 31.248 219.104 30.784 218.336 30.432C217.568 30.08 216.784 29.904 215.984 29.904C215.152 29.904 214.4 30.08 213.728 30.432C213.056 30.752 212.48 31.2 212 31.776C211.52 32.32 211.136 32.96 210.848 33.696C210.592 34.432 210.464 35.216 210.464 36.048C210.464 36.88 210.592 37.664 210.848 38.4C211.104 39.136 211.472 39.792 211.952 40.368C212.464 40.912 213.056 41.344 213.728 41.664C214.432 41.984 215.216 42.144 216.08 42.144C216.88 42.144 217.664 42 218.432 41.712C219.232 41.392 219.872 40.944 220.352 40.368L224.72 45.696C223.728 46.656 222.448 47.408 220.88 47.952C219.312 48.496 217.648 48.768 215.888 48.768C214 48.768 212.24 48.48 210.608 47.904C208.976 47.328 207.552 46.496 206.336 45.408C205.152 44.288 204.208 42.944 203.504 41.376C202.832 39.808 202.496 38.032 202.496 36.048C202.496 34.096 202.832 32.336 203.504 30.768C204.208 29.2 205.152 27.872 206.336 26.784C207.552 25.664 208.976 24.816 210.608 24.24C212.24 23.632 213.984 23.328 215.84 23.328C216.704 23.328 217.552 23.408 218.384 23.568C219.248 23.728 220.064 23.952 220.832 24.24C221.632 24.496 222.352 24.832 222.992 25.248C223.664 25.632 224.24 26.064 224.72 26.544L220.16 31.824ZM253.181 35.952C253.181 37.904 252.829 39.68 252.125 41.28C251.421 42.848 250.461 44.192 249.245 45.312C248.029 46.4 246.621 47.248 245.021 47.856C243.421 48.464 241.709 48.768 239.885 48.768C238.093 48.768 236.381 48.464 234.749 47.856C233.149 47.248 231.741 46.4 230.525 45.312C229.341 44.192 228.397 42.848 227.693 41.28C226.989 39.68 226.637 37.904 226.637 35.952C226.637 34 226.989 32.24 227.693 30.672C228.397 29.104 229.341 27.776 230.525 26.688C231.741 25.6 233.149 24.768 234.749 24.192C236.381 23.616 238.093 23.328 239.885 23.328C241.709 23.328 243.421 23.616 245.021 24.192C246.621 24.768 248.029 25.6 249.245 26.688C250.461 27.776 251.421 29.104 252.125 30.672C252.829 32.24 253.181 34 253.181 35.952ZM245.597 35.952C245.597 35.184 245.469 34.432 245.213 33.696C244.957 32.96 244.589 32.32 244.109 31.776C243.629 31.2 243.037 30.736 242.333 30.384C241.629 30.032 240.813 29.856 239.885 29.856C238.957 29.856 238.141 30.032 237.437 30.384C236.733 30.736 236.141 31.2 235.661 31.776C235.213 32.32 234.861 32.96 234.605 33.696C234.381 34.432 234.269 35.184 234.269 35.952C234.269 36.72 234.381 37.472 234.605 38.208C234.861 38.944 235.229 39.616 235.709 40.224C236.189 40.8 236.781 41.264 237.485 41.616C238.189 41.968 239.005 42.144 239.933 42.144C240.861 42.144 241.677 41.968 242.381 41.616C243.085 41.264 243.677 40.8 244.157 40.224C244.637 39.616 244.989 38.944 245.213 38.208C245.469 37.472 245.597 36.72 245.597 35.952ZM283.509 45.744C283.509 48.08 283.173 50.112 282.501 51.84C281.829 53.568 280.885 54.992 279.669 56.112C278.453 57.264 276.965 58.112 275.205 58.656C273.477 59.232 271.557 59.52 269.445 59.52C267.333 59.52 265.157 59.2 262.917 58.56C260.709 57.92 258.789 56.992 257.157 55.776L261.093 50.16C262.245 51.184 263.509 51.936 264.885 52.416C266.293 52.928 267.669 53.184 269.013 53.184C271.317 53.184 273.013 52.576 274.101 51.36C275.221 50.144 275.781 48.528 275.781 46.512V45.072H275.637C274.901 46.032 273.909 46.8 272.661 47.376C271.413 47.952 269.989 48.24 268.389 48.24C266.565 48.24 264.949 47.92 263.541 47.28C262.133 46.608 260.933 45.712 259.941 44.592C258.981 43.472 258.245 42.176 257.733 40.704C257.221 39.2 256.965 37.616 256.965 35.952C256.965 34.288 257.221 32.704 257.733 31.2C258.245 29.696 258.981 28.368 259.941 27.216C260.933 26.064 262.133 25.152 263.541 24.48C264.949 23.776 266.549 23.424 268.341 23.424C269.845 23.424 271.285 23.728 272.661 24.336C274.037 24.944 275.141 25.888 275.973 27.168H276.069V24.096H283.509V45.744ZM276.021 35.904C276.021 35.104 275.877 34.336 275.589 33.6C275.333 32.864 274.949 32.224 274.437 31.68C273.925 31.104 273.317 30.656 272.613 30.336C271.909 30.016 271.109 29.856 270.213 29.856C269.317 29.856 268.517 30.016 267.813 30.336C267.141 30.656 266.565 31.088 266.085 31.632C265.605 32.176 265.237 32.816 264.981 33.552C264.725 34.288 264.597 35.072 264.597 35.904C264.597 36.704 264.725 37.472 264.981 38.208C265.237 38.944 265.605 39.6 266.085 40.176C266.565 40.72 267.141 41.168 267.813 41.52C268.517 41.84 269.317 42 270.213 42C271.109 42 271.909 41.84 272.613 41.52C273.349 41.168 273.957 40.72 274.437 40.176C274.949 39.632 275.333 38.992 275.589 38.256C275.877 37.52 276.021 36.736 276.021 35.904Z"
            fill="white"
          />
          <defs>
            <linearGradient
              id="paint0_linear_1060_66734"
              x1="28.1423"
              y1="23.7476"
              x2="-0.45561"
              y2="51.5045"
              gradientUnits="userSpaceOnUse"
            >
              <stop stop-color="#9866FF" />
              <stop offset="1" stop-color="#C3A6FF" />
            </linearGradient>
            <linearGradient
              id="paint1_linear_1060_66734"
              x1="17.7729"
              y1="29.882"
              x2="22.0384"
              y2="35.5693"
              gradientUnits="userSpaceOnUse"
            >
              <stop stop-color="#0F0F12" stop-opacity="0.1" />
              <stop offset="1" stop-color="#0F0F12" stop-opacity="0" />
            </linearGradient>
            <linearGradient
              id="paint2_linear_1060_66734"
              x1="9.13405"
              y1="42.3512"
              x2="37.2388"
              y2="14.2465"
              gradientUnits="userSpaceOnUse"
            >
              <stop stop-color="#9866FF" />
              <stop offset="1" stop-color="#C3A6FF" />
            </linearGradient>
            <linearGradient
              id="paint3_linear_1060_66734"
              x1="2.13275"
              y1="54.3377"
              x2="20.6166"
              y2="34.432"
              gradientUnits="userSpaceOnUse"
            >
              <stop stop-color="#9C6CFF" />
              <stop offset="1" stop-color="#925CFF" />
            </linearGradient>
            <linearGradient
              id="paint4_linear_1060_66734"
              x1="19.1484"
              y1="30.8349"
              x2="37.6766"
              y2="18.5151"
              gradientUnits="userSpaceOnUse"
            >
              <stop stop-color="#AD85FF" />
              <stop offset="1" stop-color="#CEB7FF" />
            </linearGradient>
          </defs>
        </svg>
      </div>
      {/* Waveform */}
      <div
        style={{
          borderRadius: 12,
          paddingTop: 6,
          paddingBottom: 6,
        }}
        tw="flex-1 w-full h-full flex items-center justify-between"
      >
        {audioArrayFinal.map((value, index) => (
          <div
            key={index}
            tw="flex"
            style={{
              height: `${value * 100}%`,
              width: `${100 / audioArrayFinal.length}%`,
              paddingRight: 4,
              paddingLeft: 4,
            }}
          >
            <div
              style={{
                backgroundColor: primaryColor,
                width: "100%",
                height: "100%",
                borderRadius: 9999,
              }}
            ></div>
          </div>
        ))}
      </div>
    </div>
  );
}
